SQL queries (copy-paste these)
A — Top 5 products by total sales (revenue)
SELECT p.product_id,
       p.name,
       p.category,
       SUM(oi.quantity * oi.unit_price) AS total_sales,
       SUM(oi.quantity) AS total_units_sold
FROM order_items oi
JOIN products p ON oi.product_id = p.product_id
GROUP BY p.product_id, p.name, p.category
ORDER BY total_sales DESC
LIMIT 5;

B — Customer spend summary (orders count, total spent)
SELECT c.customer_id,
       c.first_name,
       c.last_name,
       COUNT(DISTINCT o.order_id) AS orders_count,
       COALESCE(SUM(oi.quantity * oi.unit_price), 0) AS total_spent
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
LEFT JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY c.customer_id, c.first_name, c.last_name
ORDER BY total_spent DESC;

C — Order detail with customer and line items (replace :order_id with a real id)
SELECT o.order_id,
       o.order_date,
       o.total_amount,
       o.status,
       c.customer_id,
       c.first_name,
       c.last_name,
       c.email,
       oi.order_item_id,
       p.product_id,
       p.name AS product_name,
       oi.quantity,
       oi.unit_price,
       (oi.quantity * oi.unit_price) AS line_total
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
JOIN products p ON oi.product_id = p.product_id
WHERE o.order_id = 1; -- <— change 1 to any valid order_id

D — Monthly sales (month, total revenue, orders count)
SELECT strftime('%Y-%m', order_date) AS year_month,
       COUNT(DISTINCT order_id) AS orders_count,
       COALESCE(SUM(oi.quantity * oi.unit_price), 0) AS total_revenue
FROM orders o
LEFT JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY year_month
ORDER BY year_month DESC;

E — Product reviews summary (avg rating, review count)
SELECT p.product_id,
       p.name,
       COUNT(r.review_id) AS reviews_count,
       ROUND(AVG(r.rating), 2) AS avg_rating
FROM products p
LEFT JOIN reviews r ON p.product_id = r.product_id
GROUP BY p.product_id, p.name
ORDER BY avg_rating DESC NULLS LAST, reviews_count DESC;
